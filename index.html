<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>
      Standing on the Shoulders of Giants – The Kotti Web Application Framework
    </title>
    <meta name="description"
          content="Standing on the Shoulders of Giants – The Kotti Web Application Framework">
    <meta name="author"
          content="Andreas Kaiser">
    <meta name="apple-mobile-web-app-capable"
          content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style"
          content="black-translucent" />
    <meta name="viewport"
          content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
    <link rel="stylesheet"
          href="css/font-awesome.min.css"
          id="fontawesome">
    <!-- Code syntax highlighting -->
    <link rel="stylesheet"
          href="lib/css/zenburn.css">
    <link rel="stylesheet"
          href="css/custom.css"
          id="theme">
    <!-- Printing and PDF exports -->
    <script>
      var link = document.createElement( 'link' );
      link.rel = 'stylesheet';
      link.type = 'text/css';
      link.href = window.location.search.match( /print-pdf/gi ) ? 'css/print/pdf.css' : 'css/print/paper.css';
      document.getElementsByTagName( 'head' )[0].appendChild( link );
    </script>
    <!--[if lt IE 9]>
    <script src="lib/js/html5shiv.js"></script>
    <![endif]-->
  </head>
  <body>

    <div class="reveal">
      <div class="slides">

        <!-- Frontpage -->
        <section id="section_frontpage">
          <h2>Standing on the Shoulders of Giants</h3>
          <h1>
            The <a href="http://kotti.pylonsproject.org/">Kotti</a> Web Application Framework
          </h1>
        </section>

        <section id="section_who">
          <h1>
            <i class="fa fa-user"></i>
            Andreas Kaiser
          </h1>
          <p>
            <a href="http://xo7.de/">
              <i class="fa fa-building"></i>
              Owner &amp; CTO of Xo7 GmbH
            </a>
            |
            <a href="https://www.google.de/maps/place/Willich/@51.2612575,6.5194918,5z/data=!4m2!3m1!1s0x47b8ae6d41015221:0x42760fc4a2a76f0">
              <i class="fa fa-map-marker"></i>
              Willich, Germany (next to Düsseldorf)
            </a>
          </p>
          <p class="hidden">
            <a href="mailto:kaiser@xo7.de">
              <i class="fa fa-envelope"></i>
              kaiser@xo7.de
            </a>
            |
            <a href="mailto:disko@binary-punks.com">
              <i class="fa fa-envelope"></i>
              disko@binary-punks.com
            </a>
          </p>
          <p>
            <a href="https://twitter.com/diskokaiser/">
              <i class="fa fa-twitter"></i>
              @diskokaiser
            </a>
            |
            <a href="https://github.com/disko">
              <i class="fa fa-github"></i>
              disko
            </a>
            |
            <a href="irc://irc.freenode.net/#kotti">
              <i class="fa fa-users"></i>
              irc://irc.freenode.net/#kotti
            </a>
          </p>
          <aside class="notes">
            <ul>
              <li>Good afternoon everyone</li>
              <li>I'm Andreas</li>
              <li>I live and work in Germany in a small city in the outskirts of Düsseldorf</li>
              <li>not really used to giving talks at conferences</li>
              <li>even less in english</li>
              <li>be patient</li>
              <li>hope you can stand my terrible accent for the next 25 minutes</li>
            </ul>
          </aside>
        </section>

        <section id="outline">
          <aside class="notes">
            <ul>
              <li>obviuosly about Kotti</li>
              <li>
                will cover
                <ul>
                  <li>why Kotti came into existance in the first place</li>
                  <li>who these giants are, on whose shoulders Kotti stands</li>
                  <li>how Kotti is built on top of them</li>
                  <li>and finally I'll show you some code examples, to make it easier for you to understand, what it's like to work with Kotti</li>
                </ul>
              </li>
            </ul>
          </aside>
          <h1>This Talk</h1>
          <ul>
            <li>
              <strong>Why does Kotti exist?</strong>
            </li>
            <li>
              <strong>Who are these giants?</strong>
            </li>
            <li>
              <strong>How are they utilized by Kotti?</strong>
            </li>
            <li>
              <strong>Example / Code</strong>
            </li>
            <li>
              <strong>Q&amp;A</strong> (if we have time)
            </li>
          </ul>
        </section>

        <section id="section_why">
          <h1>
            Why?
          </h1>
          <section id="subsection_why_orly" class="fragments">
            <aside class="notes">
              <ul>
                <li>so…</li>
                <li>another web application framework</li>
                <li>really???</li>
                <li>aren't there already dozens, or even hundreds of them around?</li>
                <li>why not just pick one of them?</li>
                <li>
                  As a matter of fact all of the Kotti core developers have some common history
                </li>
              </ul>
            </aside>
            <h2>
              Yet another web framework?
            </h2>
            <img src="img/orly.jpg" alt="O RLY?" class="fragment">
<!--             <div class="fragment">
              <p>Aren't there already dozens (hundreds?) out there?</p>
              <p>Just pick one!</p>
            </div>
 -->          </section>
        </section>

        <section id="plone">
          <img src="img/plone.png" alt="Plone" height="150">
          <section>
            <h2>Features</h2>
            <ul>
              <li>full featured CMS</li>
              <li>lots of add ons (varying quality)</li>
              <li>OFS (object file system)</li>
              <li>security (permissions, roles, groups)</li>
              <li>workflows</li>
            </ul>
            <aside class="notes">
              <ul>
                <dl>
                  <dt>Full featured CMS</dt>
                  <dt>Has lots and lots of add ons (of varying quality, but still.</dt>
                  <dt>Uses Object File System</dt>
                  <dd>A simple, yet effective way to persist objects.</dd>
                  <dd>More or less plain Python objects are stored in an object DB.</dd>
                  <dd>It supports a folder / file like object tree.</dd>
                  <dt>security</dt>
                  <dd>Has great security features.</dd>
                  <dd>Has the concepts of groups, users, roles and permissions which enables you to write applications with very fine grained security.</dd>
                  <dd>also: great security track record with very few vulnerabilities compared to other systems of that kind.</dd>
                  <dt>Workflows</dt>
                  <dd>are an absolute killer feature, that was unprecedented at that time.</dd>
                </dl>
              </ul>
            </aside>
          </section>
          <section>
            <p>
              Can be a perfect choice when it fits your needs
            </p>
            <h2 class="strong">but</h2>
            <p>
              does <strong>not</strong> fit <strong>all</strong> kinds of applications.
            </p>
            <aside class="notes">
              <ul>
                <li>
                  if you have a classic CMS use case, or need an enterprise CMS application, it's probably a perfect choice.
                </li>
                <li>BUT</li>
                <li>
                  if you need to implement a highly customized application with some CMS like features, it can quickly become overkill and a major pain.
                </li>
              </ul>
            </aside>
          </section>
          <section>
            <p>
              <img src="img/toomanystrings.jpg" alt="too many strings" width="450px">
            </p>
            <aside class="notes">
              <p>
                It often has <strong>too many</strong> features out of the box, that you just don't need.
              </p>
            </aside>
          </section>
          <section>
            <img src="img/firefighter.jpg" alt="firefighter" width="450px">
            <aside class="notes">
              <p>and you constantly find yourself fighting the framework</p>
            </aside>
          </section>
          <section>
            <aside class="notes">
              <ul>
                <li>
                  This is particulary caused by the underlying software stack
                </li>
                <li>huge: consists of some 300 packages</li>
                <li>
                  uses multiple competing technologies, which
                </li>
                <li>
                  don't conform to "The Zen of Python"
                  <ul>
                    <li>
                      to have &ldquo;preferably <strong>only one</strong> obvious <strong>way to do</strong>&rdquo; things
                    </li>

                  </ul>
                </li>
                <li>based on the monolithic Zope 2 AND the component based Zope 3 stacks</li>
                <li>uses adapters, multiadapters and utilities all over the place</li>
                <li>long story short…</li>
              </ul>
            </aside>
            <ul>
              <li>
                multiple competing technologies
              </li>
              <li>
                doesn't conform to "The Zen of Python"
              </li>
              <li>
                complex
              </li>
            </ul>
          </section>
          <section>
            <img src="img/doesntfit.jpg" alt="Does not fit my brain!">
            <aside class="notes">
              fortunately there are smarter people than me, who
              <ul>
                <li>
                  have a similar history and
                </li>
                <li>
                  wanted to preserve the most important features, that Zope pioneered back in the days.
                </li>
                <li>
                  This all with a modern, clean and maintainable code base.
                </li>
                <li>
                  This was the birth of Pyramid, then known as repoze.bfg
                </li>
              </ul>
            </aside>
          </section>
        </section>

        <section id="pyramid">
          <img src="img/pyramid.png" alt="Pyramid" height="150">
          <section>
            &#160;
            <aside class="notes">
              Greatest thing about Pyramid: fits even my brain
            </aside>
          </section>
          <section>
            <img src="img/fitsmybrain.png" alt="Fits my brain!">
          </section>
          <section>
            <h2>Features</h2>
            <ul class="fragments">
              <li>
                small core
              </li>
              <li>
                excellent documentation
              </li>
              <li>
                pythonic
              </li>
              <li>
                low level (micro framework)
              </li>
              <aside class="notes">
                It has
                <ul>
                  <li>small core,</li>
                  <li>excellent documentation,</li>
                </ul>
                Is
                <ul>
                  <li>pythonic and rather</li>
                  <li>low level, which is why you can also sort it into the group of microframeworks</li>
                </ul>
                And it's also… unopinionated, which means it
                <ul>
                  <li>
                    makes no assumptions about stuff like persistence and forms
                  </li>
                  <li>
                    and only basic assumptions about authentication and authorization, which you could call
                  </li>
                  <li>
                    the least common denominator for all kinds of web applications.
                  </li>
                </ul>
                This all makes it a great…
                <ul>
                  <li>framework framework</li>
                  <li>a framework to build your own framework, which supports <strong>your</strong> opinions</li>
                </ul>
              </aside>
              <li class="fragment">
                unopinionated
                <ul>
                  <li>
                    persistence
                  </li>
                  <li>
                    templating / forms
                  </li>
                  <li>
                    authentication / authorization sources
                  </li>
                </ul>
              </li>
              <li class="fragment">
                <q cite="http://trypyramid.com/">
                  &ldquo;framework framework&rdquo;
                </q>
              </li>
            </ul>
          </section>
          <section>
            <h2>Conclusion</h2>
            <ul>
              <li>
                only provides stuff we need
              </li>
              <li>
                doesn't come with unneeded ballast
              </li>
              <li>
                no need to<br>
                <nobr>
                  <q cite="http://trypyramid.com/">
                    &ldquo;waste time fighting the framework's decisions&rdquo;
                  </q>
                </nobr>
              </li>
              <li>perfect foundation!</li>
            </ul>
            <aside class="notes">
              so…
              <ul>
                <li>Pyramid only provides what you need in every web application.</li>
                <li>Doesn't come with unneeded ballast.</li>
                <li>There's no need to waste time fighting the framework's decisions</li>
                <li>This makes it a perfect foundation for your own frameowrk.</li>
              </ul>
              …what's left to do: make some choices that pyramid didn't make for us (by intention).
            </aside>
          </section>
          <section>
            <h2>Make some choices!</h2>
            <ul>
              <li>
                persistence
              </li>
              <li>
                traversal or URL dispatch
              </li>
              <li>
                templating &amp; forms
              </li>
              <li>
                authentication &amp; authorization sources
              </li>
            </ul>
            <aside class="notes">
              Choices we need to make are about
              <ul>
                <li><strong>persistence:</strong> obviosly need some means of storage for most applications</li>
                <li><strong>templating, forms and user input validation:</strong></li>
                <li><strong>authentication &amp; authorization sources</strong></li>
              </ul>
            </aside>
          </section>
        </section>

        <section id="section_sqlalchemy">
          <img src="img/sqlalchemy.png" alt="SQLAlchemy" height="150">
          <section>
            <ul>
              <li>
                probably the most advanced ORM for Python
              </li>
              <li>
                database agnostic
              </li>
              <li>
                has many nice, useful features
                <ul>
                  <li>hybrid properties</li>
                  <li>association proxies</li>
                  <li>ordering list</li>
                </ul>
              </li>
              <li>
                transaction integration with pyramid
              </li>
            </ul>
            <aside class="notes">
              (bulletpoints)
              <ul>
                <li>
                  Particularly useful: transactions can be bound to the lifecycle of a Pyramid request <br>through the use of the <code>pyramid_tm</code> and <code>zope.sqlalchemy</code> packages.
                </li>
              </ul>
            </aside>
          </section>
          <section>
            <aside class="notes">
              <p>
                Kotti implements a Node class in pure SQLAlchemy, that implements what we had with the Object Filesystem in Zope.
              </p>
              <p>(bulletpoints)</p>
            </aside>
            <h1>
              <i class="fa fa-sitemap"></i>
              The Node Class
            </h1>
            <ul>
              <li>
                adjacency list pattern
                <ul>
                  <li>parent</li>
                  <li>children</li>
                </ul>
              </li>
              <li>
                single root node => node tree
              </li>
              <li>
                dictionary protocol
              </li>
            </ul>
          </section>
          <section>
            <h1>
              <i class="fa fa-sitemap"></i>
              The Node Class
            </h1>
            <h2 class="strong">
              Dictionary Protocol
            </h2>
            <pre><code class="python">
from kotti.resources import Document
from kotti.resources import get_root

root = get_root()

root['about']
&lt;Document 2 at /about&gt;

root['my-document'] = Document(title='My Document', description='foo',
                               body='<p>some HTML</p>')
            </code></pre>
            <aside class="notes">
              implementing the dictionary protocol means that
              <ul>
                <li>
                  you can treat any instance of the Node class as an dictionary and
                </li>
                <li>
                  get items by their name / key and
                </li>
                <li>
                  also set them like you would with a dictionary.
                </li>
              </ul>
            </aside>
          </section>
          <section>
            <h1>
              <i class="fa fa-sitemap"></i>
              The Node Class
            </h1>
            <h2 class="strong">
              Traversal
            </h2>
            <pre><code class="python">
a = root['a'] = Document(title='A', description='Document A')
b = root['a']['b'] = Document(title='B', description='Document B')
c = root['a']['b']['c'] = Document(title='C', description='Document C')
            </code></pre>

            <table>
              <thead>
                <tr>
                  <th>Object</th>
                  <th>URL</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td>a</td>
                  <td>/a</td>
                </tr>
                <tr>
                  <td>b</td>
                  <td>/a/b</td>
                </tr>
                <tr>
                  <td>c</td>
                  <td>/a/b/c</td>
                </tr>
              </tbody>
            </table>
            <aside class="notes">
              <p>
                This instantaneously gives us traversal support with Pyramid, as Pyramid "only" requires a __getitem__ method to be implemented, which is exactly the same what a dict does.
              </p>
              <p>
                Beyond that we only need to have an ACL property on the node class to have persistent and inheritable ACLs.
              </p>
            </aside>
          </section>
          <section>
            <h1>Polimorphic queries</h1>
            <pre><code>
from kotti.resources import get_root
from kotti.resources import Node

root = get_root()
print root.children:
    print(type(c))

"&lt;class 'kotti.resources.Document'&gt;"
"&lt;class 'kotti.resources.File'&gt;"

print Node.query.filter(Node.title == 'My Document').one()
"&lt;Document 5 at /my-document&gt;"
            </code></pre>
            <aside class="notes">
              <ul>
                <li>In Kotti SQLAlchemy is set up to do polymorphic queries.</li>
                <li>Single query can return objects of multiple types.</li>
                <li>For example querying for Nodes will hand you back instances of Document and File if the Nodes happen to be of that types.</li>
              </ul>
            </aside>
          </section>
          <section>
            <h1>Joined Table Inheritance</h1>
            <ul>
              <li>class hierarchy is broken up among dependent tables</li>
              <li>each class represented by its own table</li>
              <li>the respective table only includes attributes local to that class</li>
            </ul>
            <aside class="notes">
              <p>Joined Table Inheritance is another nice feature of SQLAlchemy that we use in Kotti.</p>
              <p>It means that…</p>
              <ul>
                <li>class hierarchy is broken up among dependent tables.</li>
                <li>Each class is represented by its own table.</li>
                <li>The respective table only includes attributes local to that class.</li>
              </ul>
            </aside>
          </section>
          <section>
            <h1>Events</h1>
            <ul>
              <li>
                before_flush
                <ul>
                  <li>ObjectUpdate</li>
                  <li>ObjectInsert</li>
                  <li>ObjectDelete</li>
                </ul>
              </li>
            </ul>
            <aside class="notes">
              The last feature of SQLAlchemy, that I'd like to mention are Events.
              <ul>
                <li>
                  SQLAlchemy has a lot of them, but in Kotti we use only one: before_flush
                </li>
                <li>
                  A flush is basically the moment when SQLAlchemy talks to the database.
                </li>
                <li>
                  It is NOT the same as a commit. It rather is SQLAlchemy emitting SQL and sending it to the DB, which can happen multiple times during a transaction. ((unit of work pattern))
                </li>
                <li>
                  Of course a commit always includes a flush.
                </li>
              </ul>
              A SQLAlchemy before flush event can trigger multiple more nuanced events in Kotti. This is a mere convenience thing to ease creation of respective event subscribers in Kotti.
            </aside>
          </section>
          <section>
            <h1>Alembic</h1>
            <ul>
              <li>DB migrations</li>
              <li>DDL (transactional, if supported by DBMS)</li>
              <li>DML</li>
              <li>environments</li>
            </ul>
            <aside class="notes">
              Not exactly part of SQLAlchemy, but closely related (and also written by Mike Bayer) is Alembic.
              <ul>
                <li>DB Migration tool that supports</li>
                <li>transactional Data Definition Language operations (such as CREATE or ALTER TABLE) and</li>
                <li>transactional Data Manipulation Language operations.</li>
              </ul>
              Another useful feature:
              <ul>
                <li>supports multiple environments.</li>
                <li>Comes in extremely handy for add ons in Kotti: each add on can have its own, independent migration steps.</li>
              </ul>
              <p>
                Kotti provides a script to perform either specific migrations or all migrations for itself and all add ons at once. You can either upgrade to specific revisions or to the latest known revision.
              </p>
              <p>
                Downgrades are also supported for the case that something goes south during a migration and your DB does not support transactional DDL.
              </p>
            </aside>
          </section>
        </section>

        <section>
          <img src="img/bootstrap.png" alt="Bootstrap" height="150">
          <section>
            <ul>
              <li>
                has all the components for modern UIs
              </li>
              <li>
                responsive
              </li>
              <li>
                well known
              </li>
              <li>
                easy to customize
              </li>
            </ul>
            <p>
              <img src="img/bootstrap_components.png" alt="Bootstrap">
            </p>
            <aside class="notes">
              <p>
                Unless you have a UI designer on your team and can be sure that he or she will stay, you shouldn't even try to invent something yourself.
              </p>
              <p>
                Instead: just use Bootstrap.
              </p>
              <p>(bulletpoints)</p>
            </aside>
          </section>
        </section>

        <section>
          <img src="img/colander_deform.png" alt="Colander & Deform"
               height="150">
          <section>
            <aside class="notes">
              Next: forms. Most form libraries handle
              <ul>
                <li>creation of forms as well as their validation.</li>
                <li>Colander and Deform are different in that aspect.</li>
                <li>With Colander you can (bulletpoints).</li>
                <li>But it doesn't know anything about forms at all.</li>
              </ul>
              This is where deforms comes in…
            </aside>
            <h2>Colander</h2>
            <ul>
              <li>
                define data schema
              </li>
              <li>
                validate &amp; deserialize
                <ul>
                  <li>HTML forms</li>
                  <li>JSON</li>
                  <li>XML</li>
                </ul>
              </li>
              <li>
                serialize Python structures to
                <ul>
                  <li>strings</li>
                  <li>mappings</li>
                  <li>lists</li>
                </ul>
              </li>
            </ul>
          </section>
          <section>
            <h2>Deform</h2>
            <ul>
              <li>
                render HTML forms from structures serialized by Colander
              </li>
              <li>
                outputs Bootstrap 3 forms (Deform 2)
              </li>
            </ul>
            <aside class="notes">
              Deform…
              <ul>
                <li>…only renders forms from datastructures passed by colander.</li>
                <li>Deform 2 uses Bootstrap 3 by default.</li>
                <li>In fact Deform 2 is a merge of Deform 1 and deform_bootstrap, that we developed for earlier versions of Kotti. (it was a set of bootstrap templates for deform)</li>
                <li>Doesn't know anything about serialization or validation</li>
              </ul>
              This decoupling absolutely makes sense, as you might want to
              <ul>
                <li>take user input not only from forms, but as well as from say Javascript applications or XML RPC endpoints or similar.</li>
              </ul>
            </aside>
          </section>
        </section>

        <section>
          <img src="img/repoze.workflow.png" alt="repoze.workflow"
               height="150">
          <section>
            <aside class="notes">
              repoze.workflow is another package from the Pylons ecosystem.
              <ul>
                <li>A content workflow system that supports the concepts of <strong>states</strong> and <strong>transitions</strong>.</li>
                <li><strong>States</strong> define a role to permission mapping</li>
                <li><strong>Transitions</strong> define transitions between states, and the circumstances in which the transition may be executed</li>
              </ul>
              repoze.workflow allows us to implement the complete and exact feature set of the aforementioned killer feature of Zope and Plone in a very easy way.
            </aside>
            <ul>
              <li>
                a content workflow system
              </li>
              <li>
                <strong>states</strong> define
                <ul>
                  <li>
                    role / permission mapping
                  </li>
                </ul>
              </li>
              <li>
                <strong>transitions</strong> define
                <ul>
                  <li>
                    from_state
                  </li>
                  <li>
                    to_state
                  </li>
                  <li>
                    required permission
                  </li>
                </ul>
              </li>
            </ul>
          </section>
        </section>

        <section>
          <img src="img/depot.png" alt="Depot" height="150">
          <section>
            <ul>
              <li>
                storing and serving files in web applications
              </li>
              <li>
                multiple backends
                <ul>
                  <li>local filesystem</li>
                  <li>S3</li>
                  <li>GridFS</li>
                  <li>roll your own</li>
                </ul>
              </li>
              <li>
                integrates with SQLAlchemy
                <ul>
                  <li>
                    files are handled like a plain model attribute
                  </li>
                  <li>
                    transaction aware
                  </li>
                </ul>
              </li>
            </ul>
            <aside class="notes">
              Another giant that recently made it into Kotti is Depot. It's a package for…
              <ul>
                <li>storing and serving files in web applications.</li>
                <li>it supports: (bulletpoints)</li>
                <li><strong>transaction aware</strong> rollback or abort of a transaction causes the files to be deleted from the configured backend</li>
                <li>Don't get drawn away by its version (0.0.6 ATM)!</li>
                <li>Excellent docs, good codebase, complete test coverage.</li>
                <li>There's a dedicated talk on Depot tomorrow at 11:00 in the Barria2 room. Don't miss it!
                </li>
              </ul>
            </aside>
          </section>
        </section>

        <section>
          <img src="img/kotti.png" alt="Kotti" height="150">
          <section>
            <h1>
              Wiring it all together…
            </h1>
            <aside class="notes">
              <p>Let's finally come to Kotti itself.</p>
              <p>As mentioned in the talk outline, it's a rather small package, that wires all those giants together in a sensible way.</p>
            </aside>
          </section>
          <section>
            <aside class="notes">
              <ul>
                <li>Started by Daniel Nouri in 2011.</li>
                <li>He did the first version in just 2 days and that version already contained most of the Node class i mentioned before.</li>
                <li>I learned about Kotti and joined the project a year later, in 2012 (Plone Konferenz)</li>
              </ul>
              <ul>
                <li>1.0.0 in January 2015</li>
                <li>Biggest mistake in terms of marketing: we should've released a v1.0 in place of 0.6 or 0.7 already.</li>
                <li>Kotti was already absolutely stable and used in several production systems at that time, so calling it 1.0 would definitively have been justified.</li>
                <li>The Number of features in 0.10 alone would have justified 3 or 4 releases / versions.</li>
                <li>With 1.0.0 switched to semver
                <ul>
                  <li>major version increases with backward incompatible changes</li>
                  <li>minor version increases with feature additions</li>
                  <li>and patch is reserved for bugfixes</li>
                </ul>
                </li>
                <li>~9k dl/month according to PyPI</li>
                <li>5 contributors with push permission</li>
                <li>~40 contibutors overall.</li>
                <li>That makes us a still small, but active & healthy community.</li>
                <li>Of course contributions are always welcome, even (or especially) if it's just a missing comma or some unclear wording in the docs.</li>
              </ul>
            </aside>
            <ul>
              <li>started by Daniel Nouri in 2011</li>
              <li>BSD licensed</li>
              <li>1.0.0 in January 2015</li>
              <li>current version: 1.1.4</li>
              <li>9k downloads per month</li>
              <li>still small, but active &amp; healthy community</li>
              <li>contributions are always welcome</li>
            </ul>
          </section>
          <section>
            <h1 class="strong">Code Quality</h1>
            <p>a.k.a. "everyone loves badges"</p>
            <aside class="notes">
              We pay great attention to code quality
              <ul>
                <li>extensive test suite based on py.test</li>
                <li>Heavy use of reusable fixtures.</li>
                <li>Fixtures are exposed a a pytest plugin, that you can easily use in your addons' tests.</li>
              </ul>
              <ul>
                <li>Travis CI</li>
                <li>every commit and pull request</li>
              </ul>
              <ul>
                <li>recently a number of tools for static source code analysis came into life</li>
                <li>you shouldn't blindly follow all of their suggestions / issues they report, some of them are non-issues</li>
                <li>BUT they can give VERY valueable insights on your code and help you improve</li>
              </ul>
              <ul>
                <li>Also try very hard to keep all of our requirements up to date and continue to succeed with that with one minor exception in our testing requirements. So technically the last badge is lying a bit.</li>
              </ul>
            </aside>
            <div class="fragments">
              <dl class="fragment">
                <dt>
                  <img src="img/coverage.svg" alt="" height="45">
                </dt>
                <dd>
                  <i>almost</i> Heisenberg quality
                </dd>
              </dl>
              <dl class="fragment">
                <dt>
                  <img src="img/travis.svg" alt="" height="45">
                </dt>
                <dd>
                  continuous integration (Python 2.6, 2.7, PostgreSQL, MySQL, SQLite)
                </dd>
              </dl>
              <p>&#160;</p>
              <dl class="fragment">
                <dt>
                  <img src="img/codacy.svg" alt="" height="45">
                  <img src="img/codeclimate.svg" alt="" height="45">
                  <img src="img/quantifiedcode.svg" alt="" height="45">
                </dt>
                <dd>
                  static code analysis (<a href="https://www.codacy.com/public/disko/Kotti/dashboard">Codacy</a>, <a href="https://codeclimate.com/github/Kotti/Kotti">Code Climate</a>, <a href="https://www.quantifiedcode.com/app/project/f2a648c15f8e42788aaa4fa12a82df93">QuantifiedCode</a>)
                </dd>
              </dl>
              <dl class="fragment">
                <dt>
                  <img src="img/requires.svg" alt="" height="45">
                </dt>
                <dd>
                  (except 1 testing requirement)
                </dd>
              </dl>
            </div>
          </section>
<!--
          <section>
            <h1>Fixture Dependencies</h1>
            <img src="img/fixtures.svg" alt="">
          </section>
 -->
          <section>
            <aside class="notes">
              Configuration of Kotti is done completely through a PasteScript INI file as shown here. Kotti is a plain Pyramid and therefore also WSGI application that can be run under your prefered WSGI server.
              <dl>
                <dt>fanstatic</dt>
                <dd>Fanstatic is a framework for the automatic publication of Javascript and CSS resources on a web page.</dd>
                <dd>When we started using it in 2012 most JS libraries were not available through a package manager (NPM / Bower) and build tools for JS/CSS didn't exist in the way they do today.</dd>
                <dd>We currently are thinking bout if it makes sense to get rid of fanstatic in Kotti v2, but we're not sure yet what would be a better story.</dd>
              </dl>
            </aside>
            <h1 class="strong">Configuration</h1>
            <pre><code class="ini">[app:kotti]
use = egg:kotti
sqlalchemy.url = sqlite:///%(here)s/Kotti.db
# sqlalchemy.url = postgres://user:pass@host/db
kotti.configurators =
    kotti_tinymce.kotti_configure
    kotti_youraddon.kotti_configure

[filter:fanstatic]
use = egg:fanstatic#fanstatic

[pipeline:main]
pipeline =
    fanstatic
    kotti

[server:main]
use = egg:waitress#main
host = 127.0.0.1
port = 5000
</code></pre>
          </section>
          <section>
            <aside class="notes">
            <ul>
              <li>
                Almost every aspect of Kotti can be configured with an option in the INI file.
              </li>
              <li>
                Kotti provides sensible defaults for each option, so you don't have to specify any of them.
              </li>
              <li>
                I'm starting to run out of time already, so I won't go into detail here.
              </li>
              <li>
                The important thing to take away from this is: you can override almost everthing in Kotti, but you dont need to.
              </li>
            </ul>
            </aside>
            <h1 class="strong">Example Options</h1>
            <table>
              <thead>
                <tr>
                  <th>Option</th>
                  <th>Purpose</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td>kotti.available_types</td>
                  <td>List of active content types</td>
                </tr>
                <tr>
                  <td>kotti.configurators</td>
                  <td>List of advanced functions for config</td>
                </tr>
                <tr>
                  <td>kotti.root_factory</td>
                  <td>Override Kotti’s default Pyramid root factory</td>
                </tr>
                <tr>
                  <td>kotti.populators</td>
                  <td>List of functions to fill initial database</td>
                </tr>
                <tr>
                  <td>kotti.search_content</td>
                  <td>Override Kotti’s default search function</td>
                </tr>
                <tr>
                  <td>kotti.asset_overrides</td>
                  <td>Override Kotti’s templates</td>
                </tr>
                <tr>
                  <td>kotti.authn_policy_factory</td>
                  <td>Component used for authentication</td>
                </tr>
                <tr>
                  <td>kotti.authz_policy_factory</td>
                  <td>Component used for authorization</td>
                </tr>
              </tbody>
            </table>
          </section>
          <section>
            <h1 class="strong">Example Options (continued)</h1>
            <table>
              <thead>
                <tr>
                  <th>Option</th>
                  <th>Purpose</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td>kotti.caching_policy_chooser</td>
                  <td>Component for choosing the cache header policy</td>
                </tr>
                <tr>
                  <td>kotti.url_normalizer</td>
                  <td>Component used for url normalization</td>
                </tr>
                <tr>
                  <td>kotti.max_file_size</td>
                  <td>Max size for file uploads</td>
                </tr>
                <tr>
                  <td>kotti.depot.*.*</td>
                  <td>Configure the blob storage</td>
                </tr>
                <tr>
                  <td>kotti.sanitizers</td>
                  <td>Configure available sanitizers</td>
                </tr>
                <tr>
                  <td>kotti.sanitize_on_write</td>
                  <td>Configure sanitizers to be used on write access to resource objects</td>
                </tr>
              </tbody>
            </table>
          </section>
          <section>
            <aside class="notes">
              <p>Let me give you just 1 example of how we combine multiple "best of breed" components to a fully functional system.</p>
              <p>w.r.t. security we use: (bulletpoints)</p>
              <ul>
                <li>

                </li>
                <li>
                  ACLs are JSON serialized Pyramid ACLs
                </li>
              </ul>
            </aside>
            <h1 class="strong">Security</h1>
            <ul>
              <li>
                use SQLAlchemy to…
                <ul>
                  <li>
                    store pricipals (users &amp; groups) in the DB
                  </li>
                  <li>
                    attach (inheritable) ACLs to each node
                  </li>
                </ul>
              </li>
              <li>
                use Pyramid for…
                <ul>
                  <li>
                    authentication
                  </li>
                  <li>
                    authorization
                  </li>
                </ul>
              </li>
              <li>
                use repoze.workflow to…
                <ul>
                  <li>
                    recompute ACLs on workflow state changes
                  </li>
                </ul>
              </li>
            </ul>
          </section>
        </section>

        <section id="section_example">
          <h1>Example</h1>
          <section>
          <aside class="notes">
            Finally let's create a Kotti add on, to show you what it's like to work with Kotti.
            <ul>
              <li>We provide a complete Kotti scaffold (based on Pyramid's pcreate command) with Kotti.</li>
              <li>After running that command, you have a fully functional add-on for Kotti, with a complete test suite and CI on Travis CI setup already.</li>
            </ul>
            The created package also contains…
            <ul>
              <li>a custom content type</li>
              <li>a default and alternate view for that type</li>
              <li>completely setup i18n infrastructure</li>
              <li>an also completely setup alembic environment, so that you only need to write the actual migration steps (if that should become necessary in future versions of your add on)</li>
              <li>fanstatic resources local to this add on</li>
            </ul>
            The scaffold is also…
            <ul>
              <li>…always kept up to date, to adhere to the most recent coding conventions as suggested by the Kotti team</li>
              <li>completely tested within our CI setup, so that we can be sure it is working as expected at any time.</li>
            </ul>
          </aside>
            <h2 class="strong">Creating an addon</h2>
            <pre><code class="shell">$ pcreate -s kotti kotti_myaddon
Author name [Andreas Kaiser]:
Author email [disko@binary-punks.com]:
Github username [Kotti]:
[… lot of output …]
===============================================================================
Welcome to Kotti!

Documentation: http://kotti.readthedocs.org/
Development:   https://github.com/Kotti/Kotti/
Issues:        https://github.com/Kotti/Kotti/issues?state=open
IRC:           irc://irc.freenode.net/#kotti
Mailing List:  https://groups.google.com/group/kotti
===============================================================================
            </code></pre>
          </section>
          <section>
            <aside class="notes">
              The custom content type looks similar to this.
              <ul>
                <li>It inherits from Kotti's Content class, which is again a sane default that you probably should inherit all your types from.</li>
                <li>It has an ID column, that is both the PK and a FK to the parent table's id column. This is needed for SQLAlchemy's Joined Table Inheritance.</li>
                <li>Then it has the attributes that are actualy added by this class in addition to the inherited ones.</li>
                <li>Last there's a type_info, that tells Kotti how, where and under wich conditions that Content Type should be made available through the UI.</li>
              </ul>
            </aside>
            <h2 class="strong">
              Custom Content Type
            </h2>
            <pre class="fragments"><code>from kotti.resources import Content
from sqlalchemy import *

class Document(Content):</code><code class="fragment">
    id = Column(Integer(),
                ForeignKey('contents.id'),
                primary_key=True)</code><code class="fragment">
    body = Column(UnicodeText())
    mime_type = Column(String(30))</code><code class="fragment">
    type_info = Content.type_info.copy(
        name=u'Document',
        title=_(u'Document'),
        add_view=u'add_document',
        addable_to=[u'Document'])</code></pre>
          </section>
          <section>
            <img src="img/screen_addmenu.png" alt="Add menu">
          </section>
          <section>
            <aside class="notes">
              <p>Next there's the Colander schema definition, responsible for serialization, deserialization, validation and form creation through Deform.</p>
              <p>It by default also inherits from the parent's schema and only adds schema nodes provided by the custom content type.</p>
            </aside>
            <h2 class="strong">
              Schema definition for <br>
              validation and form creation
            </h2>
            <pre><code>import colander
import deform
from kotti.views.edit.content import ContentSchema

class DocumentSchema(ContentSchema):
    body = colander.SchemaNode(
        colander.String(),
        title=_(u'Body'),
        widget=deform.widget.RichTextWidget(),
        missing=u"")</code></pre>
          </section>

          <section>
            <aside class="notes">
              The add and edit forms are declared like this:
              <ul>
                <li>They're, like everything in Kotti, plain Pyramid views that are configured by the usual view_config decorator.</li>
                <li>They're protected by some permissions, that you can – again, like everything in Kotti – adjust to fit your specific needs.</li>
                <li>The actual form rendering and validation is again provided by the base classes. You don't have to do anything yourself, unless you want something to be done differently.</li>
                <li>What you see here is a complete and working example!</li>
              </ul>
            </aside>
            <h2 class="strong">Add / edit forms</h2>
            <pre><code>from kotti.resources import Document
from kotti.views.form import AddFormView
from kotti.views.form import EditFormView
from pyramid.view import view_config

@view_config(name=Document.type_info.add_view, permission='add',
             renderer='kotti:templates/edit/node.pt')
class DocumentAddForm(AddFormView):
    schema_factory = DocumentSchema
    add = Document
    item_type = _(u"Document")

@view_config(context=Document, name='edit', permission='edit',
             renderer='kotti:templates/edit/node.pt')
class DocumentEditForm(EditFormView):
    schema_factory = DocumentSchema</code></pre>
          </section>
          <section>
            <img src="img/screen_addform.png" alt="Add form">
            <aside class="notes">
              This is what the forms from that example look like: plain Bootstrap, good looking by default, easily customizable.
            </aside>
          </section>
          <section>
            <img src="img/screen_addvalidation.png" alt="Add validation">
            <aside class="notes">
              This is a validation error.
              <ul>
                <li>All error messages, as well as labels are fully internationalized.</li>
                <li>
                  We currently ship with translations for 8 languages. As always: contributions are very welcome.
                </li>
              </ul>
            </aside>
          </section>
          <section class="fragments">
            <aside class="notes">
              Last but not least, here's the code for some views for our content type
              <ul>
                <li>again, it's just ordinary Pyramid views, just like everything in Kotti.</li>
                <li>In this first view we specify a template for rendering.</li>
                <li>In Kotti we use Chameleon templates (as we're used to them because of our Plone / Zope history).</li>
                <li>If you prefer some other templating language: just use it. You can even mix arbitrary templating languages, because Pyramid supports that of course.</li>
              </ul>
              This does exactly the same, just in a class based approach.
              <ul>
                <li>Nice thing about it: you can group multiple views that share some common code or view configuration.</li>
                <li>You can then add additional views with even less code or configuration.</li>
                <li>Of course views don't need to be rendered via templates, they can for example also provide JSON.</li>
                <li>Again: this all is working and complete code, not just excerpts.</li>
              </ul>
            </aside>
            <h2 class="strong">View(s)</h2>
            <pre><code class="python">from pyramid.view import view_config
@view_config(name='view', context=Document, permission='view',
             renderer='kotti:templates/view/document.pt')
def document_view(context, request):
    return {}</code></pre>

            <div class="fragment">
              <h3>or</h3>

              <pre><code class="python">from pyramid.view import view_config
from pyramid.view import view_defaults
from kotti.views import BaseView

@view_defaults(context=Document, permission='view')
class DocumentViews(BaseView):
    @view_config(name='view', renderer='kotti:templates/view/document.pt')
    def view(self):
        return {}</code><code class="fragment">
    @view_config(name='view2', renderer='kotti:templates/view/document2.pt')
    def view(self):
        return {'answer': 42}</code><code class="fragment">
    @view_config(name='json', renderer='json')
    def view(self):
        return {'title': self.context.title, 'body': self.context.body, ...}
        # return self.context
        </code></pre>
            </div>
          </section>
          <section>
            <aside class="notes">
              <p>Finally this is the template our view uses. Nothing special again.</p>
              <p>The templates provided by Kotti (like the tags template included in this example) can of course be individually overriden.</p>
            </aside>
            <h2 class="strong">Template(s)</h2>
            <pre><code>&lt;!DOCTYPE html&gt;
&lt;html xmlns="http://www.w3.org/1999/xhtml"
      metal:use-macro="api.macro('kotti:templates/view/master.pt')"&gt;
  &lt;article metal:fill-slot="content" class="document-view content"&gt;
    &lt;h1&gt;${context.title}&lt;/h1&gt;
    &lt;p class="lead"&gt;
      ${context.description}
    &lt;/p&gt;
    &lt;div tal:replace="api.render_template('kotti:templates/view/tags.pt')" /&gt;
    &lt;div class="body" tal:content="structure context.body | None"&gt;
    &lt;/div&gt;
  &lt;/article&gt;
&lt;/html&gt;</code></pre>
          </section>
          <section>
            <aside class="notes">
              This is what it looks like. And that finishes the example.
            </aside>
            <img src="img/screen_added.png" alt="Added">
          </section>
        </section>

        <section>
          <aside class="notes">
            So, what are the future plans for Kotti?
            <ul>
              <li>
                Most important: Kotti will always stay <cite>&ldquo;lean and mean in all of the right ways&rdquo;</cite>
              </li>
              <li>
                Nothing will go into the core unless really necessary.
              </li>
              <li>
                We're even thinking of moving some code and features out of the core again and provide them as add-ons to make Kotti even leaner than it already is.
              </li>
              <li>
                Examples for that would be the multifile upload, which is a nice and very user friendly feature, but that's simply not needed for most applications and brings in some JS requirements that were not needed otherwise.
              </li>
            </ul>
            Python 3 support
            <ul>
              <li>
                shouldn't actually be that hard.
              </li>
              <li>
                All of our dependencies are Python 3 ready by now and the Kotti code already has a lot "from future imports" and stuff like that.
              </li>
              <li>
                As Kotti's development is primarily need driven and apparently no one has had the urgent enough need for Python 3 support yet, it simply hasn't been done yet.
              </li>
              <li>
                If someone would be interested in working on that during the conference: I'd be happy to team up on that!
              </li>
            </ul>
          </aside>
          <h1>The Future</h1>
          <ul>
            <li>
              will always stay <cite>&ldquo;lean and mean in all of the right ways&rdquo;</cite>
            </li>
            <li>
              Python 3 support
            </li>
          </ul>
        </section>
        <section>
          <aside class="notes">
            <ul>
              <li>So: that's it.</li>
              <li>Try it out yourself to experience all the fun it is to develop with Kotti.</li>
              <li>Thank you for listening!</li>
              <li>Any questions?</li>
            </ul>
          </aside>
          <h2>Thank you!</h2>
          <h1 class="strong">
            Questions?
          </h1>
        </section>
        <!--
          http://danielnouri.org/notes/2010/01/25/16-hours-into-a-new-cms-with-pyramid/
          http://danielnouri.org/notes/2011/11/30/how-to-write-an-add-on-for-the-kotti-cms/
          http://danielnouri.org/notes/2012/05/28/kotti-werkpalast-sprint-wrap-up/
          http://danielnouri.org/notes/2013/07/31/kotti-zidanca-sprint-report/

          0.1 - 2011-05-04
          0.2 - 2011-09-16
          0.3.0 - 2011-11-30
          0.4.0 - 2011-12-14
          0.5.0 - 2011-02-15
          0.6.0 - 2012-03-22
          0.7 - 2012-08-16
          0.8 - 2013-03-12
          0.9 - 2013-09-17
          0.10a1 - 2014-05-19
          1.0.0 - 2015-01-20
          1.1.0 2015-04-16

          OUTLINE

          - who
            - Andreas Kaiser
            - discovered Kotti around german Plone Konferenz 2012
          - why
            - Plone
              - pro
              - contra
          - what (features)
            - Kotti is a high-level, Pythonic web application framework based on Pyramid and SQLAlchemy. It includes an extensible Content Management System called the Kotti CMS.


          - how (the giants)
            - pyramid
              - unopinionated / leaves you with lots of choices to make
            - sqlalchemy
              - transaction / zope.sqlalchemy
            - alembic
            - bootstrap
            - colander / deform
            - others
              - Depot
              - Fanstatic
              - Chameleon
              - repoze.workflow
          - how (tools)
            - everyone loves badges!
            -
          - when
            - past
              - timeline
            - present
            - future
              -  roadmap
          - example
          - q&a
        -->

      </div>

    </div>

    <script src="lib/js/head.min.js"></script>
    <script src="js/reveal.js"></script>

    <script>

      // Full list of configuration options available at:
      // https://github.com/hakimel/reveal.js#configuration
      Reveal.initialize({
        width: 1920,
        height: 1080,
        controls: true,
        progress: true,
        history: true,
        center: true,

        transition: 'slide', // none/fade/slide/convex/concave/zoom

        // Optional reveal.js plugins
        dependencies: [
          { src: 'lib/js/classList.js', condition: function() { return !document.body.classList; } },
          { src: 'plugin/markdown/marked.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
          { src: 'plugin/markdown/markdown.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
          { src: 'plugin/highlight/highlight.js', async: true, condition: function() { return !!document.querySelector( 'pre code' ); }, callback: function() { hljs.initHighlightingOnLoad(); } },
          { src: 'plugin/zoom-js/zoom.js', async: true },
          { src: 'plugin/notes/notes.js', async: true }
        ]
      });

    </script>

  </body>
</html>
